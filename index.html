<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sorteio</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:system-ui}
body{background:#020617;color:white}

/* layout */
.page{display:none;padding:40px}
.active{display:block}

input{
width:100%;
padding:15px;
margin:10px 0;
border-radius:10px;
border:none;
background:#0f172a;
color:white;
}

button{
padding:15px;
border:none;
border-radius:12px;
background:#38bdf8;
font-weight:bold;
cursor:pointer;
width:100%;
}

.card{
background:#0f172a;
padding:25px;
border-radius:20px;
max-width:400px;
margin:auto;
}

.center{text-align:center}

.phone{
width:200px;
margin:20px auto;
display:block;
}

.topbar{
position:absolute;
top:20px;
left:20px;
font-weight:bold;
}

.adminBtn{
position:absolute;
top:20px;
right:20px;
cursor:pointer;
color:#38bdf8;
}

.status{
margin-top:20px;
padding:15px;
border-radius:10px;
background:#020617;
}

table{
width:100%;
margin-top:20px;
border-collapse:collapse;
}

td,th{
padding:10px;
border-bottom:1px solid #1e293b;
}
</style>
</head>

<body>

<!-- CADASTRO -->
<div id="cadastro" class="page active center">

<h2>Cria conta para participar do sorteio</h2>

<img class="phone" src="https://cdn-icons-png.flaticon.com/512/0/191.png">

<div class="card">
<input id="nome" placeholder="Nome do usuário">
<input id="numero" placeholder="Número do usuário">
<input id="email" placeholder="Email do usuário">

<button onclick="cadastrar()">Cadastrar</button>
</div>

</div>

<!-- PAINEL USUARIO -->
<div id="painel" class="page">

<div class="topbar" id="userNome"></div>
<div class="adminBtn" onclick="abrirAdmin()">Admin</div>

<div class="card center">

<h3>Faça seu depósito para participar do sorteio</h3>

<div class="status" id="status">
Estado: Não participou ainda
</div>

<br>
<button onclick="abrirDeposito()">Depositar para participar</button>

<br><br>

<h3>Sobre o Sorteio</h3>
<p style="color:#94a3b8;margin-top:10px">

Tempo do sorteio: 3 meses<br><br>

Regras:
<br>• Faça uma transferência Kwik no IBAN indicado
<br>• Envie o comprovativo
<br>• O comprovativo será validado pelo administrador
<br><br>

Licença:
Participação única por conta.
Fraudes anulam participação.

</p>

</div>
</div>

<!-- DEPOSITO -->
<div id="deposito" class="page center">

<div class="card">

<h3>Dados da Conta Kwik</h3>

<p style="margin-top:20px">
IBAN: AO06042000000000027091758<br>
Nome: Leandro António
</p>

<br>

<input type="file" id="comprovativo">

<button onclick="enviarComprovativo()">Enviar comprovante</button>

</div>

</div>

<!-- ADMIN -->
<div id="admin" class="page">

<h2>Painel de Administração</h2>

<table>
<thead>
<tr>
<th>Nome</th>
<th>Número</th>
<th>Email</th>
<th>Status</th>
<th>Validar</th>
</tr>
</thead>
<tbody id="listaUsuarios"></tbody>
</table>

</div>

<script>

let usuarios = JSON.parse(localStorage.getItem("usuarios")) || [];
let usuarioAtual = null;

function mudarPagina(id){
document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
document.getElementById(id).classList.add("active");
}

function cadastrar(){
const nome = nomeInput("nome");
const numero = nomeInput("numero");
const email = nomeInput("email");

if(!nome||!numero||!email) return alert("Preencha tudo");

const user = {nome,numero,email,status:"pendente"};
usuarios.push(user);
localStorage.setItem("usuarios",JSON.stringify(usuarios));

usuarioAtual=user;
abrirPainel();
}

function nomeInput(id){
return document.getElementById(id).value;
}

function abrirPainel(){
mudarPagina("painel");
document.getElementById("userNome").innerText=usuarioAtual.nome;
atualizarStatus();
}

function atualizarStatus(){
const s=usuarioAtual.status;

if(s==="pendente")
document.getElementById("status").innerText="Estado: Aguardando validação do comprovativo";

if(s==="aprovado")
document.getElementById("status").innerText="A participar ✔️ — Após a conclusão do sorteio receberá uma mensagem com o vencedor";

if(s==="nao")
document.getElementById("status").innerText="Estado: Não participou ainda";
}

function abrirDeposito(){
mudarPagina("deposito");
}

function enviarComprovativo(){
if(!document.getElementById("comprovativo").files[0])
return alert("Escolha um ficheiro");

usuarioAtual.status="pendente";
salvar();
alert("Comprovativo enviado! Aguarde validação.");
abrirPainel();
}

function salvar(){
localStorage.setItem("usuarios",JSON.stringify(usuarios));
}

function abrirAdmin(){
const senha=prompt("Senha admin:");
if(senha!=="1234") return;

mudarPagina("admin");
mostrarUsuarios();
}

function mostrarUsuarios(){
const tabela=document.getElementById("listaUsuarios");
tabela.innerHTML="";

usuarios.forEach((u,i)=>{
tabela.innerHTML+=`
<tr>
<td>${u.nome}</td>
<td>${u.numero}</td>
<td>${u.email}</td>
<td>${u.status}</td>
<td><button onclick="validar(${i})">Validar</button></td>
</tr>`;
});
}

function validar(i){
usuarios[i].status="aprovado";
salvar();
mostrarUsuarios();
}

</script>

</body>
</html>
